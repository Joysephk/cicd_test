name: Generate and Send ID on Pull Request

on:
  pull_request:
    types:
      - opened  # Déclenchement lorsque la PR est ouverte
      - reopened # Déclenchement si la PR est ré-ouverte

jobs:
  send_id_job:
    runs-on: ubuntu-latest

    steps:
      # Étape 1 : Générer un ID unique
      - name: Génération de l'ID
        id: generate_id
        run: echo "id=$(uuidgen)" >> $GITHUB_ENV

      # Étape 2 : Envoyer l'ID au serveur via HTTP
      - name: Envoyer l'ID au serveur
        env:
          ID: ${{ env.id }}
          SERVER_URL: "https://f30674c7-cf5f-42de-8c96-4969f0d2ffd4@emailhook.site" # Remplacez par l'URL de votre serveur
        run: |
          curl -X POST -H "Content-Type: application/json" \
          -d "{\"id\": \"${ID}\", \"pr_number\": \"${{ github.event.pull_request.number }}\"}" \
          ${SERVER_URL}
